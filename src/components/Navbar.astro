---
/**
 * UNO JERSEY - Navbar Component
 * Shared navigation for all main site pages
 */

interface Props {
  logoColor?: 'black' | 'white';
  showLogo?: boolean;
  staticTagline?: boolean;
  class?: string;
}

const { logoColor = 'black', showLogo = false, staticTagline = false, class: className = '' } = Astro.props;

const logoSrc = logoColor === 'white'
  ? '/images/UNO-White.png'
  : '/images/UNO-Black.png';

// Initial logo class - visible if showLogo prop is true
const initialLogoClass = showLogo ? 'navbar-logo-visible' : 'navbar-logo-hidden';

// Add class for static tagline (no animation, stays black/red)
const taglineClass = staticTagline ? 'tagline-static' : '';
---

<nav class={`navbar ${className}`} id="navbar">
  <div class="nav-content">
    <!-- Tagline -->
    <div class="nav-tagline" id="nav-tagline">
      <span class={`nav-tagline-text ${taglineClass}`}>Be Uno. <span class="highlight">Be United.</span></span>
    </div>

    <!-- Logo Center -->
    <div class="nav-logo-center">
      <a href="/">
        <img id="navbar-logo" src={logoSrc} alt="UNO JERSEY" class={`logo-img ${initialLogoClass}`} fetchpriority="high">
      </a>
    </div>
  </div>
</nav>

<style>
  /* Navbar Styles */
  .navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 80px;
    z-index: 1000;
    padding: 0 24px;
  }

  .nav-content {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    position: relative;
  }

  /* Tagline on left side - starts at 48px, shrinks to 24px on scroll */
  .nav-tagline {
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
  }

  .nav-tagline-text {
    font-family: 'Bebas Neue', sans-serif;
    font-weight: 700;
    font-size: 48px;
    color: #ffffff;
    white-space: nowrap;
    will-change: font-size;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    transition: color 0.3s ease, text-shadow 0.3s ease;
  }

  /* Static tagline - black & red, no animation, stays large */
  :global(.tagline-static) {
    color: #1a1a1a !important;
    text-shadow: none !important;
  }

  .navbar.scrolled .nav-tagline-text {
    color: #1a1a1a;
    text-shadow: none;
  }

  .nav-tagline-text .highlight {
    color: #E63946;
  }

  /* Logo centered in navbar */
  .nav-logo-center {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    right: 0;
    left: 0;
    top: 0;
    bottom: 0;
  }

  .nav-logo-center a {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .nav-logo-center .logo-img {
    height: 60px;
    width: auto;
    flex-shrink: 0;
  }

  /* Navbar logo visibility - GLOBAL for Hero component access */
  :global(.navbar-logo-hidden) {
    opacity: 0;
    transition: opacity 0.4s ease;
  }

  :global(.navbar-logo-visible) {
    opacity: 1;
    transition: opacity 0.4s ease;
  }

  /* On mobile, move logo to the right */
  @media (max-width: 768px) {
    .nav-content {
      justify-content: space-between;
    }

    .nav-logo-center {
      position: static;
      justify-content: flex-end;
      flex: 1;
    }

    .nav-logo-center .logo-img {
      height: 28px;
    }

    .nav-tagline-text {
      font-size: 28px;
    }
  }

  @media (max-width: 480px) {
    .nav-tagline-text {
      font-size: 22px;
    }

    .nav-logo-center .logo-img {
      height: 24px;
    }
  }

  @media (max-width: 1024px) {
    .nav-tagline-text {
      font-size: 36px;
    }

    .nav-logo-center .logo-img {
      height: 32px;
    }
  }
</style>

<script>
  // Navbar scroll behavior
  const navbar = document.getElementById('navbar');
  const navTaglineText = document.querySelector('.nav-tagline-text');
  const heroLogo = document.getElementById('hero-logo');

  if (navbar) {
    const hasHero = !!heroLogo;
    const isStaticTagline = navTaglineText?.classList.contains('tagline-static');

    function handleScroll() {
      const scrollY = window.scrollY;
      const windowHeight = window.innerHeight;

      // Add scrolled class for styling changes (skip for static tagline)
      if (!isStaticTagline) {
        if (scrollY > 50) {
          navbar.classList.add('scrolled');
        } else {
          navbar.classList.remove('scrolled');
        }
      }

      // Animate tagline size on scroll (skip for static tagline)
      if (navTaglineText && !isStaticTagline) {
        const scrollPercent = Math.min(scrollY / windowHeight, 1);
        const newSize = Math.max(48 - (scrollPercent * 24), 24); // Shrink from 48px to 24px
        navTaglineText.style.fontSize = newSize + 'px';
      }
    }

    window.addEventListener('scroll', () => {
      requestAnimationFrame(handleScroll);
    }, { passive: true });

    // Initial call
    handleScroll();

    console.log('Navbar: Initialized', hasHero ? 'with hero' : 'without hero', isStaticTagline ? 'static tagline' : 'animated tagline');
  } else {
    console.warn('Navbar: navbar element not found');
  }
</script>
